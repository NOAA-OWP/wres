<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="TimeSeries - Add scale_period" author="Christopher Tubbs">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists schemaName="wres" tableName="TimeSeries" columnName="scale_period" />
            </not>
        </preConditions>
        <addColumn schemaName="wres" tableName="TimeSeries">
            <column name="scale_period" type="integer"
                    value="1"
                    remarks="Measures the period over which values are gather. Instantaneous = 1." />
        </addColumn>
        <comment>TimeSeries - added scale_period</comment>
    </changeSet>
    <changeSet id="scale_function 1.0" author="Christopher Tubbs" dbms="PostgreSQL">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="f">
                SELECT EXISTS (
                    SELECT 1
                    FROM pg_type
                    WHERE typname = 'scale_function'
                );
            </sqlCheck>
        </preConditions>
        <sql>
            CREATE TYPE scale_function AS ENUM('UNKNOWN', 'MEAN', 'MINIMUM', 'MAXIMUM', 'TOTAL');
        </sql>
        <comment>
            Added the scale_function data type.
        </comment>
    </changeSet>
    <changeSet id="TimeSeries - Add scale_function" author="Christopher Tubbs" dbms="PostgreSQL">
        <preConditions onFail="MARK_RAN">
            <and>
                <sqlCheck expectedResult="t">
                    SELECT EXISTS (
                        SELECT 1
                        FROM pg_type
                        WHERE typname = 'scale_function'
                    );
                </sqlCheck>
                <not>
                    <columnExists schemaName="wres" tableName="TimeSeries" columnName="scale_function" />
                </not>
            </and>
        </preConditions>
        <addColumn schemaName="wres" tableName="TimeSeries">
            <column name="scale_function" type="scale_function"
                    remarks="The function used to describe the scale of the collected data"
                    value="UNKNOWN"
            />
        </addColumn>
        <comment>TimeSeries - added scale_function</comment>
    </changeSet>
    <changeSet id="TimeSeries - Add time_step" author="Christopher Tubbs">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists schemaName="wres" tableName="TimeSeries" columnName="time_step" />
            </not>
        </preConditions>
        <addColumn schemaName="wres" tableName="TimeSeries">
            <column name="time_step" type="integer"
                    remarks="The amount of time units between values. The unit is defined by the application." />
        </addColumn>
        <comment>TimeSeries - added time_step</comment>
    </changeSet>
</databaseChangeLog>