-- Remove sources that use invalid features about to be deleted.
-- Separate from the delete invalid features because tables change
-- and this query depends on quite a few tables' existence.
delete from wres.Source S
where source_id in
(
    select source_id
    from wres.TimeSeries TS
    inner join wres.VariableFeature VF
        on VF.variablefeature_id = TS.variablefeature_id
    inner join wres.Feature F
        on VF.feature_id = F.feature_id
    where F.lid in
    (
        'RDAC2',
        'NW039',
        'NW040',
        'NW053',
        'NW052',
        'NW034',
        'NW045',
        'NW165',
        'NW090',
        'NW135',
        'NW083',
        'NW261',
        'NW186',
        'NW188',
        'NW282',
        'NW306',
        'NW313',
        'NW428',
        'NW344',
        'NW399',
        'NW407',
        'NW341',
        'NW340',
        'NW343',
        'NW394',
        'NW345',
        'NW348',
        'NW362',
        'NW363',
        'NW350',
        'NW355',
        'NW463',
        'NW458',
        'NW474',
        'NW436',
        'NW432',
        'NW488',
        'NW489',
        'NW495',
        'NW529',
        'NW456',
        'NW455',
        'NW454',
        'NW487',
        'NW516',
        'NW446',
        'NW519',
        'NW521',
        'NW522',
        'NW499',
        'TORQ8',
        'NW371',
        'NW544',
        'NW540',
        'NW548',
        'NW533',
        'LRBM8',
        'NW041',
        'NW137',
        'NW504',
        'NW047',
        'NW374',
        'NW373',
        'NW431',
        'NW416',
        'NW105',
        'NW258',
        'NW257',
        'NW134',
        'NW304',
        'NW175',
        'NW413',
        'NW408',
        'NW410',
        'NW490',
        'NW460',
        'NW176',
        'NW483',
        'NW078',
        'NW392',
        'NW085',
        'NW024',
        'NW022',
        'NW098',
        'NW023',
        'NW099',
        'NW326',
        'NW500',
        'NW501',
        'NW502',
        'NW042',
        'NW043',
        'NW325',
        'NW451',
        'NW472',
        'NW097',
        'NW096',
        'NW021',
        'NW434',
        'NW106',
        'NW390',
        'NW389',
        'NW530',
        'JEFL1',
        'NW056',
        'NW333',
        'NW334',
        'NW300',
        'NW493',
        'NW281',
        'NW274',
        'NW280',
        'NW264',
        'NW277',
        'NW384',
        'CWXW1',
        'NW260',
        'PTET2',
        'NW441',
        'NW442',
        'NW279',
        'NW026',
        'NW167',
        'NW001',
        'NW430',
        'NW020',
        'NW549',
        'NW386',
        'NW485',
        'NW118',
        'NW119',
        'NW121',
        'NW217',
        'NW473',
        'NW117',
        'NW107',
        'NW108',
        'NW109',
        'NW550',
        'NW177',
        'NW076',
        'NW081',
        'NW146',
        'NW148',
        'NW025',
        'NW027',
        'NW314',
        'NW185',
        'NW170',
        'NW171',
        'NW062',
        'NW412',
        'NW156',
        'NW467',
        'NW468',
        'ANDI1',
        'NW205',
        'NW044',
        'NW360',
        'NW367',
        'NW069',
        'NW423',
        'NW425',
        'NW424',
        'NW245',
        'NW421',
        'NW422',
        'TRAM5',
        'INDN6',
        'ALKT2',
        'HRLN6',
        'AKLN6',
        'STIP1',
        'AYLP1',
        'PMTP1',
        'CREA1',
        'WPKA1',
        'MHDA1',
        'GARN8',
        'GLUN8',
        'CLLV2',
        'FTEQ6',
        'BURV1',
        'ROUN6',
        'LMIS1',
        'JACW2',
        'BRLO1',
        'KIRO1',
        'LEXO1',
        'HTRK1',
        'WDHN2',
        'NANN7',
        'GLNK1',
        'STCK1',
        'CHLI3',
        'CAGI3',
        'POEF1',
        'MCFM6',
        'ARHT2',
        'ARBO2',
        'KNGN1',
        'HUNI3',
        'SLAI3',
        'MSSI3',
        'TLDN1',
        'WLON1',
        'NWKN4',
        'BOON4',
        'BRVO3',
        'BADN7',
        'CBKS2',
        'KBYT2',
        'LCRT2',
        'SKCT2',
        'GCDW1',
        'GDDP1',
        'CNGK1',
        'JRLK1',
        'MAYO2',
        'CPLO2',
        'KERO2',
        'WFLO2',
        'EDRK1',
        'TRLK1',
        'ACRO1',
        'LEEM5',
        'MLLM5',
        'SHTQ8',
        'DMSN8',
        'LNRC1',
        'ADDT2',
        'AGTG1',
        'ALAT2',
        'BCKO1',
        'BHDO1',
        'CGRN5',
        'CJBO1',
        'CVLG1',
        'CVQC1',
        'DIXK2',
        'EGLN5',
        'FLWT2',
        'FRHT2',
        'GRET2',
        'HWDS1',
        'JPLT2',
        'KNZP1',
        'LART2',
        'MONI3',
        'PNTT2',
        'PRLI3',
        'SRLN5',
        'TIOP1',
        'UTEN5',
        'WPPM7',
        'AXTV2',
        'PINS1',
        'PNTK2',
        'LOSO3',
        'SFRW1',
        'YARW1',
        'BCVC1',
        'WLHN2',
        'RICV2',
        'FTMV2',
        'JSFV2',
        'SRDM2',
        'MEAP1',
        'MISO1',
        'WSPC2',
        'RVST1',
        'ALLM6',
        'WHNP1',
        'PRYP1',
        'SHPP1',
        'CRCP1',
        'MHGP1',
        'LYLP1',
        'BSZM7',
        'LOPO3',
        'BIGW4',
        'PHBQ7',
        'BUSP1',
        'COWP1',
        'CRWP1',
        'RTDP1',
        'SYDP1',
        'STVP1',
        'TGAP1',
        'YGBP1',
        'VARN6',
        'MRGL1',
        'STJQ7',
        'NUTQ7',
        'BURO3',
        'HOOO1'
    )
);

-- Remove the invalid locations themselves
delete from wres.Feature F
where lid in
(
    'RDAC2',
    'NW039',
    'NW040',
    'NW053',
    'NW052',
    'NW034',
    'NW045',
    'NW165',
    'NW090',
    'NW135',
    'NW083',
    'NW261',
    'NW186',
    'NW188',
    'NW282',
    'NW306',
    'NW313',
    'NW428',
    'NW344',
    'NW399',
    'NW407',
    'NW341',
    'NW340',
    'NW343',
    'NW394',
    'NW345',
    'NW348',
    'NW362',
    'NW363',
    'NW350',
    'NW355',
    'NW463',
    'NW458',
    'NW474',
    'NW436',
    'NW432',
    'NW488',
    'NW489',
    'NW495',
    'NW529',
    'NW456',
    'NW455',
    'NW454',
    'NW487',
    'NW516',
    'NW446',
    'NW519',
    'NW521',
    'NW522',
    'NW499',
    'TORQ8',
    'NW371',
    'NW544',
    'NW540',
    'NW548',
    'NW533',
    'LRBM8',
    'NW041',
    'NW137',
    'NW504',
    'NW047',
    'NW374',
    'NW373',
    'NW431',
    'NW416',
    'NW105',
    'NW258',
    'NW257',
    'NW134',
    'NW304',
    'NW175',
    'NW413',
    'NW408',
    'NW410',
    'NW490',
    'NW460',
    'NW176',
    'NW483',
    'NW078',
    'NW392',
    'NW085',
    'NW024',
    'NW022',
    'NW098',
    'NW023',
    'NW099',
    'NW326',
    'NW500',
    'NW501',
    'NW502',
    'NW042',
    'NW043',
    'NW325',
    'NW451',
    'NW472',
    'NW097',
    'NW096',
    'NW021',
    'NW434',
    'NW106',
    'NW390',
    'NW389',
    'NW530',
    'JEFL1',
    'NW056',
    'NW333',
    'NW334',
    'NW300',
    'NW493',
    'NW281',
    'NW274',
    'NW280',
    'NW264',
    'NW277',
    'NW384',
    'CWXW1',
    'NW260',
    'PTET2',
    'NW441',
    'NW442',
    'NW279',
    'NW026',
    'NW167',
    'NW001',
    'NW430',
    'NW020',
    'NW549',
    'NW386',
    'NW485',
    'NW118',
    'NW119',
    'NW121',
    'NW217',
    'NW473',
    'NW117',
    'NW107',
    'NW108',
    'NW109',
    'NW550',
    'NW177',
    'NW076',
    'NW081',
    'NW146',
    'NW148',
    'NW025',
    'NW027',
    'NW314',
    'NW185',
    'NW170',
    'NW171',
    'NW062',
    'NW412',
    'NW156',
    'NW467',
    'NW468',
    'ANDI1',
    'NW205',
    'NW044',
    'NW360',
    'NW367',
    'NW069',
    'NW423',
    'NW425',
    'NW424',
    'NW245',
    'NW421',
    'NW422',
    'TRAM5',
    'INDN6',
    'ALKT2',
    'HRLN6',
    'AKLN6',
    'STIP1',
    'AYLP1',
    'PMTP1',
    'CREA1',
    'WPKA1',
    'MHDA1',
    'GARN8',
    'GLUN8',
    'CLLV2',
    'FTEQ6',
    'BURV1',
    'ROUN6',
    'LMIS1',
    'JACW2',
    'BRLO1',
    'KIRO1',
    'LEXO1',
    'HTRK1',
    'WDHN2',
    'NANN7',
    'GLNK1',
    'STCK1',
    'CHLI3',
    'CAGI3',
    'POEF1',
    'MCFM6',
    'ARHT2',
    'ARBO2',
    'KNGN1',
    'HUNI3',
    'SLAI3',
    'MSSI3',
    'TLDN1',
    'WLON1',
    'NWKN4',
    'BOON4',
    'BRVO3',
    'BADN7',
    'CBKS2',
    'KBYT2',
    'LCRT2',
    'SKCT2',
    'GCDW1',
    'GDDP1',
    'CNGK1',
    'JRLK1',
    'MAYO2',
    'CPLO2',
    'KERO2',
    'WFLO2',
    'EDRK1',
    'TRLK1',
    'ACRO1',
    'LEEM5',
    'MLLM5',
    'SHTQ8',
    'DMSN8',
    'LNRC1',
    'ADDT2',
    'AGTG1',
    'ALAT2',
    'BCKO1',
    'BHDO1',
    'CGRN5',
    'CJBO1',
    'CVLG1',
    'CVQC1',
    'DIXK2',
    'EGLN5',
    'FLWT2',
    'FRHT2',
    'GRET2',
    'HWDS1',
    'JPLT2',
    'KNZP1',
    'LART2',
    'MONI3',
    'PNTT2',
    'PRLI3',
    'SRLN5',
    'TIOP1',
    'UTEN5',
    'WPPM7',
    'AXTV2',
    'PINS1',
    'PNTK2',
    'LOSO3',
    'SFRW1',
    'YARW1',
    'BCVC1',
    'WLHN2',
    'RICV2',
    'FTMV2',
    'JSFV2',
    'SRDM2',
    'MEAP1',
    'MISO1',
    'WSPC2',
    'RVST1',
    'ALLM6',
    'WHNP1',
    'PRYP1',
    'SHPP1',
    'CRCP1',
    'MHGP1',
    'LYLP1',
    'BSZM7',
    'LOPO3',
    'BIGW4',
    'PHBQ7',
    'BUSP1',
    'COWP1',
    'CRWP1',
    'RTDP1',
    'SYDP1',
    'STVP1',
    'TGAP1',
    'YGBP1',
    'VARN6',
    'MRGL1',
    'STJQ7',
    'NUTQ7',
    'BURO3',
    'HOOO1'
);

-- Remove all wres.Project (and wres.ProjectSource) rows, they can be rebuilt
-- by projects at runtime relatively cheaply compared to wres.TimeSeries data
-- and corresponding wres.Source data.
delete from wres.Project;
